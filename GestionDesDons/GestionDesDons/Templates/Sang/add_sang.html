{% load static %}
{% load widget_tweaks %}

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>Ajouter / Modifier une poche de sang - DonVia</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <!-- Bootstrap & style -->
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
</head>
<body style="background-color: #f8f9fa;">

<div class="container d-flex align-items-center justify-content-center" style="min-height:100vh;">
    <div class="text-center w-100">
        <div class="bg-white p-4 rounded shadow mx-auto" style="max-width:720px; text-align:left;">

            <!-- Titre -->
            <h1 id="page-title" class="mb-4 text-center">
                {% if form.instance.pk %}
                    Modifier une poche de sang
                {% else %}
                    Ajouter une poche de sang
                {% endif %}
            </h1>

            <!-- Formulaire -->
            <form method="post" action="{% url 'sang:ajouter_sang' %}" novalidate>
                {% csrf_token %}

                <!-- Groupe sanguin -->
                <div class="mb-3">
                    <label for="{{ form.groupe_sanguin.id_for_label }}" class="form-label">Groupe sanguin</label>
                    {{ form.groupe_sanguin|add_class:"form-select"|add_error_class:"is-invalid" }}
                    {% for error in form.groupe_sanguin.errors %}
                        <div class="invalid-feedback">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Rhésus -->
                <div class="mb-3">
                    <label for="{{ form.rhesus.id_for_label }}" class="form-label">Rhésus</label>
                    {{ form.rhesus|add_class:"form-select"|add_error_class:"is-invalid" }}
                    {% for error in form.rhesus.errors %}
                        <div class="invalid-feedback">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Type de don -->
                <div class="mb-3">
                    <label for="{{ form.type_don.id_for_label }}" class="form-label">Type de don</label>
                    {{ form.type_don|add_class:"form-select"|add_error_class:"is-invalid" }}
                    {% for error in form.type_don.errors %}
                        <div class="invalid-feedback">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Quantité -->
                <div class="mb-3">
                    <label for="{{ form.quantite.id_for_label }}" class="form-label">Quantité (litres)</label>
                    {{ form.quantite|add_class:"form-control"|add_error_class:"is-invalid"|attr:"step=0.01|min=0" }}
                    {% for error in form.quantite.errors %}
                        <div class="invalid-feedback">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Statut -->
                <div class="mb-3">
                    <label for="{{ form.status.id_for_label }}" class="form-label">Statut</label>
                    {{ form.status|add_class:"form-select"|add_error_class:"is-invalid" }}
                    {% for error in form.status.errors %}
                        <div class="invalid-feedback">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Date de collecte -->
                <div class="mb-3">
                    <label for="{{ form.date_collecte.id_for_label }}" class="form-label">Date de collecte</label>
                    {{ form.date_collecte|add_class:"form-control"|add_error_class:"is-invalid"|attr:"type=date" }}
                    {% for error in form.date_collecte.errors %}
                        <div class="invalid-feedback">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Date d'expiration -->
                <div class="mb-3">
                    <label for="{{ form.date_expiration.id_for_label }}" class="form-label">Date d'expiration</label>
                    {{ form.date_expiration|add_class:"form-control"|add_error_class:"is-invalid"|attr:"type=date" }}
                    {% for error in form.date_expiration.errors %}
                        <div class="invalid-feedback">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Lieu de stockage -->
                <div class="mb-3">
                    <label for="{{ form.lieu_stockage.id_for_label }}" class="form-label">Lieu de stockage</label>
                    {{ form.lieu_stockage|add_class:"form-control"|add_error_class:"is-invalid" }}
                    {% for error in form.lieu_stockage.errors %}
                        <div class="invalid-feedback">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Erreurs globales -->
                {% if form.non_field_errors %}
                    <div class="alert alert-danger mt-3">
                        {{ form.non_field_errors }}
                    </div>
                {% endif %}

                <!-- Boutons -->
                <div class="d-flex gap-2 justify-content-center mt-4">
                    <button type="submit" class="btn btn-primary">Enregistrer</button>
                    <a href="{% url 'sang:liste_sangs' %}" class="btn btn-secondary">Annuler</a>
                </div>
            </form>

        </div>
    </div>
</div>

<!-- Bootstrap -->
<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
</body>
</html>
